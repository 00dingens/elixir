#!/bin/sh
readlink_f () {
  cd "$(dirname "$1")" > /dev/null
  local filename="$(basename "$1")"
  if [ -h "$filename" ]; then
    readlink_f "$(readlink "$filename")"
  else
    echo "`pwd -P`/$filename"
  fi
}

OPTS=()
EXTRA=()

while [ -n "$1" ]; do
  case "$1" in
    --remsh)
        EXTRA=("${EXTRA[@]}" "$1" "$2")
        shift 2
        ;;
    --)
        EXTRA=("${EXTRA[@]}" "$@")
        break
        ;;
    *)
        OPTS=("${OPTS[@]}" "$1")
        shift
        ;;
  esac
done

SELF=$(readlink_f "$0")
SCRIPT_PATH=$(dirname "$SELF")
"$SCRIPT_PATH"/elixir --no-halt -e "IEx.cli" "${OPTS[@]}" -- "${EXTRA[@]}"